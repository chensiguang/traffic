<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" ><mapper namespace="com.web.dao.CarDao">	<!-- 车辆管理 -->	<resultMap id="BaseResultMap" type="com.web.pojo.Car">		<id 	column="carid" 			property="carid" 			jdbcType="INTEGER" />		<result column="DeviceID"  		property="deviceid"  		jdbcType="VARCHAR" />		<result column="SIMcard" 		property="simCard" 			jdbcType="VARCHAR" />		<result column="BusOwnerCode" 	property="busOwnerCode" 	jdbcType="VARCHAR" />		<result column="BusLicPlate" 	property="busLicPlate" 		jdbcType="VARCHAR" />		<result column="Driver1"  	   	property="driver1"  		jdbcType="VARCHAR" />		<result column="Phone1" 	   	property="phone1" 			jdbcType="VARCHAR" />		<result column="Driver2"  	   	property="driver2"  		jdbcType="VARCHAR" />		<result column="Phone2"        	property="phone2" 			jdbcType="VARCHAR" />		<result column="Maxton"        	property="maxton"  			jdbcType="INTEGER" />		<result column="MaxOil"        	property="maxoil" 			jdbcType="INTEGER" />		<result column="MaintainTime" 	property="maintainTime" 	jdbcType="TIMESTAMP" />		<result column="MaintainDay"   	property="maintainDay" 		jdbcType="INTEGER" />		<result column="MaintainMile"  	property="maintainMile" 	jdbcType="INTEGER" />		<result column="MaintainCMile" 	property="maintainCMile"	jdbcType="INTEGER" />		<result column="FactoryType"   	property="factoryType"  	jdbcType="VARCHAR" />		<result column="Manufacturer"  	property="manufacturer" 	jdbcType="VARCHAR" />		<result column="BusType"       	property="busType"  		jdbcType="VARCHAR" />		<result column="BusColor"      	property="busColor" 		jdbcType="VARCHAR" />		<result column="OperatingId"   	property="operatingId"  	jdbcType="VARCHAR" />		<result column="FuelLevel"     	property="fuelLevel" 		jdbcType="VARCHAR" />		<result column="EngineSN"      	property="engineSN"  		jdbcType="VARCHAR" />		<result column="Chassis" 		property="chassis" 			jdbcType="VARCHAR" />		<result column="GoodsType"  	property="goodsType"  		jdbcType="VARCHAR" />		<result column="OilConsume" 	property="oilConsume" 		jdbcType="FLOAT" />		<result column="BusLen"  		property="busLen"  			jdbcType="FLOAT" />		<result column="OneWayDistance" property="oneWayDistance" 	jdbcType="INTEGER" />		<result column="StopTime"  		property="stopTime"  		jdbcType="INTEGER" />		<result column="RegCode" 		property="regCode" 			jdbcType="VARCHAR" />		<result column="Registered"  	property="registered"  		jdbcType="INTEGER" />		<result column="RegStartTime"  	property="regStartTime" 	jdbcType="TIMESTAMP" />		<result column="RegEndTime"    	property="regEndTime" 		jdbcType="TIMESTAMP" />		<result column="comid"  		property="comid" 			jdbcType="INTEGER" />		<result column="areaid"  		property="areaid" 			jdbcType="INTEGER" />				<result column="operid"   		property="operid" 			jdbcType="INTEGER" />	    <result column="opertime" 		property="opertime" 		jdbcType="TIMESTAMP" />	    <result column="regid" 			property="regid" 			jdbcType="INTEGER" />	    <result column="regtime" 		property="regtime" 			jdbcType="TIMESTAMP" />	    <result column="state" 			property="state" 			jdbcType="INTEGER" />	    <result column="remark" 		property="remark" 			jdbcType="VARCHAR" />	         <collection property="admin" javaType="com.web.pojo.Admin">        <id property="userno" jdbcType="INTEGER" />       <result property="username" jdbcType="VARCHAR" />     </collection>    	    <!-- 关联的Company表 -->	    <collection  column="comid" 	property="company" 			ofType="com.web.pojo.Company" >	    	<id 	 column="comid" 	property="comid" 			jdbcType="INTEGER" />        			<result  column="comname" 	property="comname"			jdbcType="VARCHAR" /> 	    </collection>	    	    <!-- 关联的Area表 -->	    <collection  column="areaid" 	property="area" 			ofType="com.web.pojo.Area" >	    	<id 	 column="areaid" 	property="areaid" 			jdbcType="INTEGER" />        			<result  column="areaname" 	property="areaname"			jdbcType="VARCHAR" /> 	    </collection>	</resultMap>		<!-- 前台显示 -->	<select id="selectCarList" resultMap="BaseResultMap" >		select 			*		from tp_basic_car c1 		left join tp_basic_company c2 		on (c1.comid = c2.comid and c2.state = 1)		where c1.state = 1 	    order by c1.regtime desc limit ${param1},${param2}  	</select>  			<select id="selectCarListByDwid" resultMap="BaseResultMap" >		select *		from tp_basic_car 		where state = 1 		and comid = #{dwid}	     	</select>  		<select id="selectCount" resultType="java.lang.Integer" >	    select count(carid) 	    from tp_basic_car 	    where state = 1 	    order by regtime desc  	</select>  	<select id="selectCarInfoById" resultMap="BaseResultMap" >		select 			* 		from tp_basic_car c1 		left join tp_basic_company c2 		on (c1.comid = c2.comid and c2.state = 1)		where c1.state = 1 and c1.carid = #{carid,jdbcType=INTEGER}  	</select>  	  	<!-- 后台管理 -->  		  		<!-- 查找操作人 -->	<select id="selectUsernameById" resultMap="BaseResultMap"		parameterType="com.web.pojo.Car">		select i.*, u.username,u.userno from tp_basic_car i left join tp_sys_user u        on i.operid = u.userno where i.carid = #{id,jdbcType=INTEGER} 	</select>  	  	<!-- 查询所有 -->  	<select id="queryAll" resultMap="BaseResultMap">  		select   			*   		from tp_basic_car   		where state = 1    		order by regtime desc   	</select>  	  	<!-- 新增-提交 -->  	<insert id="insertCar" parameterType="com.web.pojo.Car">		insert into tp_basic_car 		(			carid,busLicPlate,busType,comid,areaid,factoryType,manufacturer,regStartTime,regEndTime,			operid,opertime,state,remark,regtime,regid		)		values		(			#{carid,jdbcType=INTEGER},	   		#{busLicPlate,jdbcType=VARCHAR},	   		#{busType,jdbcType=VARCHAR},	   		#{comid,jdbcType=INTEGER},	   		#{areaid,jdbcType=INTEGER},	   		#{factoryType,jdbcType=VARCHAR},	   		#{manufacturer,jdbcType=VARCHAR},	   		#{regStartTime,jdbcType=TIMESTAMP},	   		#{regEndTime,jdbcType=TIMESTAMP},	   		#{operid,jdbcType=VARCHAR},	   		#{opertime,jdbcType=TIMESTAMP},	   		#{state,jdbcType=INTEGER},	   		#{remark,jdbcType=VARCHAR},	   		#{regtime,jdbcType=TIMESTAMP},	   		#{regid,jdbcType=VARCHAR}		)  	</insert>  	  	<!-- 修改-编辑 -->  	<select id="queryDataById" resultMap="BaseResultMap" parameterType="java.lang.Integer">		select 			* 		from tp_basic_car bc 		left join tp_basic_company cp 		on (bc.comid = cp.comid and cp.state = 1) 		left join tp_basic_area ba 		on (bc.areaid = ba.areaid and ba.state = 1) 		where bc.state = 1   		and bc.carid = #{carid,jdbcType=INTEGER}  	</select>  	  	 <select id="queryDataByCarid" resultMap="BaseResultMap" parameterType="java.lang.Integer">		select * 		from tp_basic_car		where state = 1   		and carid = #{carid,jdbcType=INTEGER}  	</select>  	  	<!-- 修改-提交 -->  	<update id="updateCar" parameterType="com.web.pojo.Car">		update tp_basic_car 		set	   		busLicPlate		= #{busLicPlate,jdbcType=VARCHAR},	   		busType       	= #{busType,jdbcType=VARCHAR},	   		comid 			= #{comid,jdbcType=INTEGER},	   		areaid    		= #{areaid,jdbcType=INTEGER},	   		manufacturer	= #{manufacturer,jdbcType=VARCHAR},	   		factoryType     = #{factoryType,jdbcType=VARCHAR},	   		remark      	= #{remark,jdbcType=VARCHAR}   		where state = 1    		and carid = #{carid,jdbcType=INTEGER}  	</update>  	  	<!-- 单个删除、批量删除 -->  	<update id="dropDataById" parameterType="java.lang.Integer">		update tp_basic_car 		set	   		state = 0   		where state = 1    		and carid = #{carid,jdbcType=INTEGER}  	</update>  	  	<!-- 查看车牌号是否重复 -->  	<select id="selectCarByBusLicPlate" resultType="java.lang.Integer" parameterType="com.web.pojo.Car">  		select   			count(*)   		from tp_basic_car  		where state = 1   		<if test="carid != null">  		and carid != #{carid,jdbcType=INTEGER}   		</if>  		and busLicPlate = #{busLicPlate,jdbcType=VARCHAR}  	</select>  	<!-- 后台分页管理 -->  	  	<!--查询总记录数 -->  	<select id="getCountByAll" resultType="java.lang.Integer" parameterType="java.util.HashMap">		select 			count(*) 		from tp_basic_car bc 		left join tp_basic_company cp 		on (bc.comid = cp.comid and cp.state = 1) 		left join tp_basic_area ba 		on (bc.areaid = ba.areaid and ba.state = 1) 		where bc.state = 1 		<if test="busLicPlate != null">		and busLicPlate like concat('%',#{busLicPlate,jdbcType=VARCHAR},'%' ) 		</if>		<if test="comid != null">		    and bc.comid = #{comid}		</if>		<if test="safecomid != null">		    and bc.comid = #{safecomid}		</if>  		order by bc.regtime desc   	</select>  	  	<!--分页、条件查询 -->  	<select id="selectPage" resultMap="BaseResultMap" parameterType="java.util.HashMap">		select 			* 		from tp_basic_car bc 		left join tp_basic_company cp 		on (bc.comid = cp.comid and cp.state = 1) 		left join tp_basic_area ba 		on (bc.areaid = ba.areaid and ba.state = 1) 		where bc.state = 1 		<if test="busLicPlate != null">		and busLicPlate like concat('%',#{busLicPlate,jdbcType=VARCHAR},'%' ) 		</if>		<if test="comid != null">		    and bc.comid = #{comid}		</if>		<if test="safecomid != null">		    and bc.comid = #{safecomid}		</if>  		order by bc.regtime desc limit #{curnum,jdbcType=INTEGER},#{pagesize,jdbcType=INTEGER}   	</select></mapper>